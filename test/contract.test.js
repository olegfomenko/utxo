const UTXO = artifacts.require("UTXO");
const BigNumber = require("bignumber.js");

describe("UTXO", () => {
  // it("Deposit 100wei", async() => {
  //   const contractInstance = await UTXO.new();
  //   let tx = await contractInstance.deposit({_x: "54533569734642344486288131029379598044451408573209191866637883276501231297446", _y: "14837800800114303506769104623010866767167925800723795707122086269674886862462"}, { value: "100"});
  //
  //   var utxo_expected = {
  //     _c: {
  //       _x: new BigNumber('88315646812608937150193518900563633917275438891687290401475032098514533897918').toFixed(),
  //       _y:  new BigNumber('7272204644080850452855114223899104111675532933968542692520976828320978133189').toFixed(),
  //     },
  //     _valuable: true,
  //   };
  //
  //   let utxo = await contractInstance.utxos(0);
  //   assert.equal(utxo._c._x, utxo_expected._c._x);
  //   assert.equal(utxo._c._y, utxo_expected._c._y);
  //   assert.equal(utxo._valuable, utxo_expected._valuable);
  // });

  it("Range proof", async() => {
    let proof = {"_e0":"52702452513606187911759513472166193535166300527950506039936199989403075264753","_c":[{"_x":"99348555241561234127465347172849627045234805516563246766718879223235077909486","_y":"23864378666149846917968637262779677760383658928960354261625059136639462875588"},{"_x":"29109818770783017430001701361671749687291749047869341184820907919009184090612","_y":"79053481946620666509068028127043490070020313007298323571344492767840048618937"},{"_x":"54084786335659580993028670252077346096765152346974530330210403412057719570760","_y":"24484984162561123578430806364484858665909686358735657516186942000197133627189"},{"_x":"81827983192951759637639334548967833175544763530750015458338959354965470367720","_y":"40712229552117073201401056064285520639291493424107814111892811483153374837602"},{"_x":"104632457110886377560599864800820932850307985821668480603693871486379765607612","_y":"99100784120612295953817118329570528256946315005667222851501544346913261241530"},{"_x":"40960704918189131427829752290432912898351671986027202343114733124503723089517","_y":"34123064787600884584498067513987991308976663775050459041392948916857378366275"},{"_x":"27636812558222030058182767707035725556116152948785516001457245611029172657313","_y":"45775071501191655148111977923371439759653581444752591719740814088329354254205"},{"_x":"347680882287209446769671841354647243161833649053687891069484679573122670977","_y":"91818135774089268401881864532150873260376493949887467451824287390631003334161"},{"_x":"52157924727169079972849456739188145653585614267747770524525773504931488389060","_y":"35263505526624343755775143466706355673147093669806098138738083071194097621645"},{"_x":"51168634480322114998882581479543357165627433317021606074158015455276128026543","_y":"57529173930900289365614862248110827624015303186617546052290804395801628470884"},{"_x":"77152388489334456531640096933178417019886171596063032615508482212770897046761","_y":"10444670855185396333013092150895266161782788767862465538874148144081827564199"},{"_x":"80534691958359503378906054937589403391826050336365592208863518432189410835739","_y":"37965733244634467820436153283772388870161875068497403535960609965031625555325"},{"_x":"96356608719994728413043931404090900961968091104525685802371869293657721250611","_y":"70378954401450766830372142108719867773533705155290440339812669882883914325915"},{"_x":"44855563700304795568347949787831635668022683956882155058178861119072985554015","_y":"89278717789546835545096158160266214467465481060838031284368757418180720391818"},{"_x":"40816598372439580020830954304715553442703137204298329436154865584379212444631","_y":"36443926894748551430289042399231557827924689446983301986741901964296648185635"},{"_x":"36252150960365166287519276335213888169664553782379453429106258752184191698193","_y":"50696598249372221182172182502495480145967565270176933865434738193187807595749"},{"_x":"41455407951755290357098856278583331021354110291119327438005978707151425837888","_y":"108236500229298008816107755332666721456168216485843588219141982728859225712511"},{"_x":"96446394828169021915307508656492747753527220546046502739943031995869422820253","_y":"34740218270326584175480440495220551150660367028183475777651418140683257138085"},{"_x":"56814159997288392059792169116422660020451602015360735890843410728613447985118","_y":"77333374525162993712101382913005457654083337966855925946791380845237230891683"},{"_x":"14210962108106107453725192235147022498476647640492889058126749961401823537061","_y":"98175984413445604625613292328796200831648266287524020205192376182168400128983"},{"_x":"17937791454625009311363674567046338621999463721830353650108229951691317576116","_y":"84423525275291171932637161775888080738914571300480705583250171857662860767877"},{"_x":"40284660777942651749769012466173766304639070675626340678929614188314397137723","_y":"99336518902224751709979386723891041718069739804735766007236449813066425518212"},{"_x":"71701414072838595263226240840601139809467796691447931828314787238691057910184","_y":"42990914824441219122275265899312122481254388151827587049786615812049689538704"},{"_x":"103172845547030427412790050450574246979136455256325576495520566795254782668290","_y":"50006548309766264759563159673420698787471430509041244285804709645190962881277"},{"_x":"3166560267321633129913227584710259443914972389204863023994356499270834757000","_y":"35261334126860001905183697422747518250917695323667575764767849712893240171939"},{"_x":"79874825111531008333004778879233638840045018419666791139384549100654935040680","_y":"53971019245197875751981556821573355662761151980218185800185480358224073784805"},{"_x":"34771195217540032807259094498745336425514775573781618071598105524563749884587","_y":"15751515021465289868390862459853426715484639599437184536737268560362595433026"},{"_x":"11335040550927224381803570038803734375095323398751932348721309221769228732619","_y":"54145332654473030270507821842110868864046394166381838153385418595565234386553"},{"_x":"50356630969637352357774577434705169057967326677455394474493786144913242041905","_y":"108920590691840700972004346925235937431207051184937650302484296509832358329211"},{"_x":"24780628112982281674819918349891384507350562288908022035060186187167885463421","_y":"66554630406702038587492170728716470314520888265857848659282669603783410534662"},{"_x":"37974320089337582866082144128518586930152934662391858726165783504444239449429","_y":"17446781597581447901158625711610801304625519821411374995363028573359376831600"},{"_x":"17762632280221001003849835350578543142638847210562719028939286547013574245743","_y":"68311227138382897831755168452200921665258449980456607547180038788821199531966"}],"_s":["37462615180553959489087537242870516954312035022975036574715407834423615094538","29923255965561484375255750788626971410514312398168300963526956906322045690147","25445355095945017883781520503502853831176923627213322049150533906375018097807","115405967751231716258351032603814027702280252853236981672721380251626976449852","90368458112341515128965533861207157244579035039400083193936613662740051304979","91762283595312189054278296787246669751504112795458229128650479724100893538021","54567273413630065544317360481697437740813142186832258514858923237479424277341","9086913610454372275857750410544226199328578310000689430763637064430313803403","8162434638535994256687607359506995425843586944182425522658681489893172306800","107044578020507747050716601195683035864178142815006902651440553909642470897988","32348165420240068912830084787629569086971837825221122978370123808207124233451","58607181923851067461920676090278660129105727866449380442241186325082641832496","90163264990576879034517366719173442292803454617361749018017138132323881529014","20693852250527717265825139758454186806685972218871650097222731320924500312478","104410004233891529060955780111366771380116020343751443549476343305909325677386","92297382541013827397704904336076708087927177101660881365607740980691032438343","7508924872229757379157800744937042806499281218530982219379370475433625806578","32472581023603905437553323633960668061897926484629016573973680455463350107684","115574701544385357611749087200467912771343968638098853337427619701216362990596","113762901037725290328579023941454553650785576153055196857838252065539119739587","5585947795084542520506515093826295923012341392892379269163956708461759383233","21728190106736486702255818168360882205224313695613051278291327245658507915888","58223454859647678530896524168625615206086313825272940948824086346996011899810","45021240048613630239022753332516098247441929701575507229557634434539548538886","66844700261078862295646001168798364451861222564486435687259510633510514422699","108190515451858046991472212989408437149548929143627358132805193803005882727748","97999471226415678495496702613422102594120810388858079866053031355120468034521","45364195087359610506549560912905517745786717897021034743522013511521809817653","40204877602345456676060587412211400538871620687977061219639419073000894848236","67857975023838546348145485971551595713482292152469995513663300080548054734989","101428784592700195672436825016165531705527333887472966153992291931916762010594","50444317692227641512832777833020236188712662159400246308039451701818534219908"]}
    let commitment = {"_x": "45571552299573111718863985425814294539208861228265073319601093157534903709702", "_y": "7234192108208997702366232742437356742933362848425139915527191823372792408407"}

    const contractInstance = await UTXO.new();
    await contractInstance.verifyRangeProof(commitment, proof);
  });
});

const wei = (value, decimal = 18) => {
  return toBN(value).times(toBN(10).pow(decimal)).toFixed();
};
